/**
 * @license
 * Cesium - https://github.com/CesiumGS/cesium
 * Version 1.111
 *
 * Copyright 2011-2022 Cesium Contributors
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * Columbus View (Pat. Pend.)
 *
 * Portions licensed separately.
 * See https://github.com/CesiumGS/cesium/blob/main/LICENSE.md for full licensing details.
 */

import{a as Z,c as u}from"./chunk-XJDXENOV.js";import{a as T}from"./chunk-G4DMKKUA.js";import{a as K}from"./chunk-3UAKIC5Y.js";import{a as J,c as W,d as E}from"./chunk-43H44XVI.js";import{g as X,q as L}from"./chunk-SN4TUFKS.js";import{c as F,d as b}from"./chunk-LNQJOB2G.js";import{a as S}from"./chunk-AUOFUFUP.js";import{a,d as B}from"./chunk-PTNIWY5H.js";import{a as R}from"./chunk-LAL3IUCV.js";import{a as d}from"./chunk-K36PKEJW.js";import{a as v,b as k}from"./chunk-YOLMPEQR.js";import{f as s}from"./chunk-DQETLSQS.js";function M(e){e=d(e,d.EMPTY_OBJECT),this.left=e.left,this._left=void 0,this.right=e.right,this._right=void 0,this.top=e.top,this._top=void 0,this.bottom=e.bottom,this._bottom=void 0,this.near=d(e.near,1),this._near=this.near,this.far=d(e.far,5e8),this._far=this.far,this._cullingVolume=new Z,this._perspectiveMatrix=new b,this._infinitePerspective=new b}function Q(e){if(!s(e.right)||!s(e.left)||!s(e.top)||!s(e.bottom)||!s(e.near)||!s(e.far))throw new v("right, left, top, bottom, near, or far parameters are not set.");let n=e.top,o=e.bottom,f=e.right,p=e.left,_=e.near,m=e.far;if(n!==e._top||o!==e._bottom||p!==e._left||f!==e._right||_!==e._near||m!==e._far){if(e.near<=0||e.near>e.far)throw new v("near must be greater than zero and less than far.");e._left=p,e._right=f,e._top=n,e._bottom=o,e._near=_,e._far=m,e._perspectiveMatrix=b.computePerspectiveOffCenter(p,f,o,n,_,m,e._perspectiveMatrix),e._infinitePerspective=b.computeInfinitePerspectiveOffCenter(p,f,o,n,_,e._infinitePerspective)}}Object.defineProperties(M.prototype,{projectionMatrix:{get:function(){return Q(this),this._perspectiveMatrix}},infiniteProjectionMatrix:{get:function(){return Q(this),this._infinitePerspective}}});var oe=new a,ie=new a,re=new a,ae=new a;M.prototype.computeCullingVolume=function(e,n,o){if(!s(e))throw new v("position is required.");if(!s(n))throw new v("direction is required.");if(!s(o))throw new v("up is required.");let f=this._cullingVolume.planes,p=this.top,_=this.bottom,m=this.right,l=this.left,t=this.near,i=this.far,g=a.cross(n,o,oe),w=ie;a.multiplyByScalar(n,t,w),a.add(e,w,w);let y=re;a.multiplyByScalar(n,i,y),a.add(e,y,y);let r=ae;a.multiplyByScalar(g,l,r),a.add(w,r,r),a.subtract(r,e,r),a.normalize(r,r),a.cross(r,o,r),a.normalize(r,r);let c=f[0];return s(c)||(c=f[0]=new F),c.x=r.x,c.y=r.y,c.z=r.z,c.w=-a.dot(r,e),a.multiplyByScalar(g,m,r),a.add(w,r,r),a.subtract(r,e,r),a.cross(o,r,r),a.normalize(r,r),c=f[1],s(c)||(c=f[1]=new F),c.x=r.x,c.y=r.y,c.z=r.z,c.w=-a.dot(r,e),a.multiplyByScalar(o,_,r),a.add(w,r,r),a.subtract(r,e,r),a.cross(g,r,r),a.normalize(r,r),c=f[2],s(c)||(c=f[2]=new F),c.x=r.x,c.y=r.y,c.z=r.z,c.w=-a.dot(r,e),a.multiplyByScalar(o,p,r),a.add(w,r,r),a.subtract(r,e,r),a.cross(r,g,r),a.normalize(r,r),c=f[3],s(c)||(c=f[3]=new F),c.x=r.x,c.y=r.y,c.z=r.z,c.w=-a.dot(r,e),c=f[4],s(c)||(c=f[4]=new F),c.x=n.x,c.y=n.y,c.z=n.z,c.w=-a.dot(n,w),a.negate(n,r),c=f[5],s(c)||(c=f[5]=new F),c.x=r.x,c.y=r.y,c.z=r.z,c.w=-a.dot(r,y),this._cullingVolume};M.prototype.getPixelDimensions=function(e,n,o,f,p){if(Q(this),!s(e)||!s(n))throw new v("Both drawingBufferWidth and drawingBufferHeight are required.");if(e<=0)throw new v("drawingBufferWidth must be greater than zero.");if(n<=0)throw new v("drawingBufferHeight must be greater than zero.");if(!s(o))throw new v("distance is required.");if(!s(f))throw new v("pixelRatio is required");if(f<=0)throw new v("pixelRatio must be greater than zero.");if(!s(p))throw new v("A result object is required.");let _=1/this.near,m=this.top*_,l=2*f*o*m/n;m=this.right*_;let t=2*f*o*m/e;return p.x=t,p.y=l,p};M.prototype.clone=function(e){return s(e)||(e=new M),e.right=this.right,e.left=this.left,e.top=this.top,e.bottom=this.bottom,e.near=this.near,e.far=this.far,e._left=void 0,e._right=void 0,e._top=void 0,e._bottom=void 0,e._near=void 0,e._far=void 0,e};M.prototype.equals=function(e){return s(e)&&e instanceof M&&this.right===e.right&&this.left===e.left&&this.top===e.top&&this.bottom===e.bottom&&this.near===e.near&&this.far===e.far};M.prototype.equalsEpsilon=function(e,n,o){return e===this||s(e)&&e instanceof M&&R.equalsEpsilon(this.right,e.right,n,o)&&R.equalsEpsilon(this.left,e.left,n,o)&&R.equalsEpsilon(this.top,e.top,n,o)&&R.equalsEpsilon(this.bottom,e.bottom,n,o)&&R.equalsEpsilon(this.near,e.near,n,o)&&R.equalsEpsilon(this.far,e.far,n,o)};var $=M;function C(e){e=d(e,d.EMPTY_OBJECT),this._offCenterFrustum=new $,this.fov=e.fov,this._fov=void 0,this._fovy=void 0,this._sseDenominator=void 0,this.aspectRatio=e.aspectRatio,this._aspectRatio=void 0,this.near=d(e.near,1),this._near=this.near,this.far=d(e.far,5e8),this._far=this.far,this.xOffset=d(e.xOffset,0),this._xOffset=this.xOffset,this.yOffset=d(e.yOffset,0),this._yOffset=this.yOffset}C.packedLength=6;C.pack=function(e,n,o){return k.typeOf.object("value",e),k.defined("array",n),o=d(o,0),n[o++]=e.fov,n[o++]=e.aspectRatio,n[o++]=e.near,n[o++]=e.far,n[o++]=e.xOffset,n[o]=e.yOffset,n};C.unpack=function(e,n,o){return k.defined("array",e),n=d(n,0),s(o)||(o=new C),o.fov=e[n++],o.aspectRatio=e[n++],o.near=e[n++],o.far=e[n++],o.xOffset=e[n++],o.yOffset=e[n],o};function z(e){if(!s(e.fov)||!s(e.aspectRatio)||!s(e.near)||!s(e.far))throw new v("fov, aspectRatio, near, or far parameters are not set.");let n=e._offCenterFrustum;if(e.fov!==e._fov||e.aspectRatio!==e._aspectRatio||e.near!==e._near||e.far!==e._far||e.xOffset!==e._xOffset||e.yOffset!==e._yOffset){if(e.fov<0||e.fov>=Math.PI)throw new v("fov must be in the range [0, PI).");if(e.aspectRatio<0)throw new v("aspectRatio must be positive.");if(e.near<0||e.near>e.far)throw new v("near must be greater than zero and less than far.");e._aspectRatio=e.aspectRatio,e._fov=e.fov,e._fovy=e.aspectRatio<=1?e.fov:Math.atan(Math.tan(e.fov*.5)/e.aspectRatio)*2,e._near=e.near,e._far=e.far,e._sseDenominator=2*Math.tan(.5*e._fovy),e._xOffset=e.xOffset,e._yOffset=e.yOffset,n.top=e.near*Math.tan(.5*e._fovy),n.bottom=-n.top,n.right=e.aspectRatio*n.top,n.left=-n.right,n.near=e.near,n.far=e.far,n.right+=e.xOffset,n.left+=e.xOffset,n.top+=e.yOffset,n.bottom+=e.yOffset}}Object.defineProperties(C.prototype,{projectionMatrix:{get:function(){return z(this),this._offCenterFrustum.projectionMatrix}},infiniteProjectionMatrix:{get:function(){return z(this),this._offCenterFrustum.infiniteProjectionMatrix}},fovy:{get:function(){return z(this),this._fovy}},sseDenominator:{get:function(){return z(this),this._sseDenominator}},offCenterFrustum:{get:function(){return z(this),this._offCenterFrustum}}});C.prototype.computeCullingVolume=function(e,n,o){return z(this),this._offCenterFrustum.computeCullingVolume(e,n,o)};C.prototype.getPixelDimensions=function(e,n,o,f,p){return z(this),this._offCenterFrustum.getPixelDimensions(e,n,o,f,p)};C.prototype.clone=function(e){return s(e)||(e=new C),e.aspectRatio=this.aspectRatio,e.fov=this.fov,e.near=this.near,e.far=this.far,e._aspectRatio=void 0,e._fov=void 0,e._near=void 0,e._far=void 0,this._offCenterFrustum.clone(e._offCenterFrustum),e};C.prototype.equals=function(e){return!s(e)||!(e instanceof C)?!1:(z(this),z(e),this.fov===e.fov&&this.aspectRatio===e.aspectRatio&&this._offCenterFrustum.equals(e._offCenterFrustum))};C.prototype.equalsEpsilon=function(e,n,o){return!s(e)||!(e instanceof C)?!1:(z(this),z(e),R.equalsEpsilon(this.fov,e.fov,n,o)&&R.equalsEpsilon(this.aspectRatio,e.aspectRatio,n,o)&&this._offCenterFrustum.equalsEpsilon(e._offCenterFrustum,n,o))};var q=C;var H=0,ce=1;function j(e){k.typeOf.object("options",e),k.typeOf.object("options.frustum",e.frustum),k.typeOf.object("options.origin",e.origin),k.typeOf.object("options.orientation",e.orientation);let n=e.frustum,o=e.orientation,f=e.origin,p=d(e.vertexFormat,T.DEFAULT),_=d(e._drawNearPlane,!0),m,l;n instanceof q?(m=H,l=q.packedLength):n instanceof u&&(m=ce,l=u.packedLength),this._frustumType=m,this._frustum=n.clone(),this._origin=a.clone(f),this._orientation=L.clone(o),this._drawNearPlane=_,this._vertexFormat=p,this._workerName="createFrustumGeometry",this.packedLength=2+l+a.packedLength+L.packedLength+T.packedLength}j.pack=function(e,n,o){k.typeOf.object("value",e),k.defined("array",n),o=d(o,0);let f=e._frustumType,p=e._frustum;return n[o++]=f,f===H?(q.pack(p,n,o),o+=q.packedLength):(u.pack(p,n,o),o+=u.packedLength),a.pack(e._origin,n,o),o+=a.packedLength,L.pack(e._orientation,n,o),o+=L.packedLength,T.pack(e._vertexFormat,n,o),o+=T.packedLength,n[o]=e._drawNearPlane?1:0,n};var fe=new q,se=new u,pe=new L,he=new a,me=new T;j.unpack=function(e,n,o){k.defined("array",e),n=d(n,0);let f=e[n++],p;f===H?(p=q.unpack(e,n,fe),n+=q.packedLength):(p=u.unpack(e,n,se),n+=u.packedLength);let _=a.unpack(e,n,he);n+=a.packedLength;let m=L.unpack(e,n,pe);n+=L.packedLength;let l=T.unpack(e,n,me);n+=T.packedLength;let t=e[n]===1;if(!s(o))return new j({frustum:p,origin:_,orientation:m,vertexFormat:l,_drawNearPlane:t});let i=f===o._frustumType?o._frustum:void 0;return o._frustum=p.clone(i),o._frustumType=f,o._origin=a.clone(_,o._origin),o._orientation=L.clone(m,o._orientation),o._vertexFormat=T.clone(l,o._vertexFormat),o._drawNearPlane=t,o};function Y(e,n,o,f,p,_,m,l){let t=e/3*2;for(let i=0;i<4;++i)s(n)&&(n[e]=_.x,n[e+1]=_.y,n[e+2]=_.z),s(o)&&(o[e]=m.x,o[e+1]=m.y,o[e+2]=m.z),s(f)&&(f[e]=l.x,f[e+1]=l.y,f[e+2]=l.z),e+=3;p[t]=0,p[t+1]=0,p[t+2]=1,p[t+3]=0,p[t+4]=1,p[t+5]=1,p[t+6]=0,p[t+7]=1}var _e=new B,le=new b,U=new b,I=new a,ee=new a,te=new a,we=new a,de=new a,ye=new a,D=new Array(3),G=new Array(4);G[0]=new F(-1,-1,1,1);G[1]=new F(1,-1,1,1);G[2]=new F(1,1,1,1);G[3]=new F(-1,1,1,1);var ne=new Array(4);for(let e=0;e<4;++e)ne[e]=new F;j._computeNearFarPlanes=function(e,n,o,f,p,_,m,l){let t=B.fromQuaternion(n,_e),i=d(_,I),g=d(m,ee),w=d(l,te);i=B.getColumn(t,0,i),g=B.getColumn(t,1,g),w=B.getColumn(t,2,w),a.normalize(i,i),a.normalize(g,g),a.normalize(w,w),a.negate(i,i);let y=b.computeView(e,w,g,i,le),r,c,x=f.projectionMatrix;if(o===H){let P=b.multiply(x,y,U);c=b.inverse(P,U)}else r=b.inverseTransformation(y,U);s(c)?(D[0]=f.near,D[1]=f.far):(D[0]=0,D[1]=f.near,D[2]=f.far);for(let P=0;P<2;++P)for(let O=0;O<4;++O){let h=F.clone(G[O],ne[O]);if(s(c)){h=b.multiplyByVector(c,h,h);let A=1/h.w;a.multiplyByScalar(h,A,h),a.subtract(h,e,h),a.normalize(h,h);let N=a.dot(w,h);a.multiplyByScalar(h,D[P]/N,h),a.add(h,e,h)}else{let A=f.offCenterFrustum;s(A)&&(f=A);let N=D[P],V=D[P+1];h.x=(h.x*(f.right-f.left)+f.left+f.right)*.5,h.y=(h.y*(f.top-f.bottom)+f.bottom+f.top)*.5,h.z=(h.z*(N-V)-N-V)*.5,h.w=1,b.multiplyByVector(r,h,h)}p[12*P+O*3]=h.x,p[12*P+O*3+1]=h.y,p[12*P+O*3+2]=h.z}};j.createGeometry=function(e){let n=e._frustumType,o=e._frustum,f=e._origin,p=e._orientation,_=e._drawNearPlane,m=e._vertexFormat,l=_?6:5,t=new Float64Array(3*4*6);j._computeNearFarPlanes(f,p,n,o,t);let i=3*4*2;t[i]=t[3*4],t[i+1]=t[3*4+1],t[i+2]=t[3*4+2],t[i+3]=t[0],t[i+4]=t[1],t[i+5]=t[2],t[i+6]=t[3*3],t[i+7]=t[3*3+1],t[i+8]=t[3*3+2],t[i+9]=t[3*7],t[i+10]=t[3*7+1],t[i+11]=t[3*7+2],i+=3*4,t[i]=t[3*5],t[i+1]=t[3*5+1],t[i+2]=t[3*5+2],t[i+3]=t[3],t[i+4]=t[3+1],t[i+5]=t[3+2],t[i+6]=t[0],t[i+7]=t[1],t[i+8]=t[2],t[i+9]=t[3*4],t[i+10]=t[3*4+1],t[i+11]=t[3*4+2],i+=3*4,t[i]=t[3],t[i+1]=t[3+1],t[i+2]=t[3+2],t[i+3]=t[3*5],t[i+4]=t[3*5+1],t[i+5]=t[3*5+2],t[i+6]=t[3*6],t[i+7]=t[3*6+1],t[i+8]=t[3*6+2],t[i+9]=t[3*2],t[i+10]=t[3*2+1],t[i+11]=t[3*2+2],i+=3*4,t[i]=t[3*2],t[i+1]=t[3*2+1],t[i+2]=t[3*2+2],t[i+3]=t[3*6],t[i+4]=t[3*6+1],t[i+5]=t[3*6+2],t[i+6]=t[3*7],t[i+7]=t[3*7+1],t[i+8]=t[3*7+2],t[i+9]=t[3*3],t[i+10]=t[3*3+1],t[i+11]=t[3*3+2],_||(t=t.subarray(3*4));let g=new K({position:new E({componentDatatype:S.DOUBLE,componentsPerAttribute:3,values:t})});if(s(m.normal)||s(m.tangent)||s(m.bitangent)||s(m.st)){let y=s(m.normal)?new Float32Array(12*l):void 0,r=s(m.tangent)?new Float32Array(3*4*l):void 0,c=s(m.bitangent)?new Float32Array(3*4*l):void 0,x=s(m.st)?new Float32Array(2*4*l):void 0,P=I,O=ee,h=te,A=a.negate(P,we),N=a.negate(O,de),V=a.negate(h,ye);i=0,_&&(Y(i,y,r,c,x,V,P,O),i+=3*4),Y(i,y,r,c,x,h,A,O),i+=3*4,Y(i,y,r,c,x,A,V,O),i+=3*4,Y(i,y,r,c,x,N,V,A),i+=3*4,Y(i,y,r,c,x,P,h,O),i+=3*4,Y(i,y,r,c,x,O,h,A),s(y)&&(g.normal=new E({componentDatatype:S.FLOAT,componentsPerAttribute:3,values:y})),s(r)&&(g.tangent=new E({componentDatatype:S.FLOAT,componentsPerAttribute:3,values:r})),s(c)&&(g.bitangent=new E({componentDatatype:S.FLOAT,componentsPerAttribute:3,values:c})),s(x)&&(g.st=new E({componentDatatype:S.FLOAT,componentsPerAttribute:2,values:x}))}let w=new Uint16Array(6*l);for(let y=0;y<l;++y){let r=y*6,c=y*4;w[r]=c,w[r+1]=c+1,w[r+2]=c+2,w[r+3]=c,w[r+4]=c+2,w[r+5]=c+3}return new W({attributes:g,indices:w,primitiveType:J.TRIANGLES,boundingSphere:X.fromVertices(t)})};var Ke=j;export{q as a,Ke as b};
